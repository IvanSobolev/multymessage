(function(){"use strict";var t={9313:function(t,e,n){var a=n(5130),s=n(2261),r=n(6768);function o(t,e,n,a,s,o){const i=(0,r.g2)("Header"),c=(0,r.g2)("Main");return(0,r.uX)(),(0,r.CE)(r.FK,null,[(0,r.bF)(i),(0,r.bF)(c)],64)}var i=n(144),c="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFoAAABaCAYAAAA4qEECAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFgklEQVR4nO2dXWgdRRSAv8R4b7Q/YFHrP63vxZ+iNaZJEfG3KIKtpkRs/SX1/wcfBPFNo1ITJCjtk0+CL2rR2lRtyIOoFUsErY/qg1VvrGlrNY2lJisDp3AJd2Z3c3dnZvfOBwfCDdk5c2bu2TNnzkwgEAgEAoFAIBAIBAKJOR1YAzwMjAC7gO+ASeAwEAEn5Ocf5XcfAK8C9wOrgdOSN9daXAQ8AYwCf4sxm5EjwE7gceACWpwq0A98DsxlYFyd/CcD2C9ttgxLgOeBP3I0rk5+BZ4BFlFy3/skMOXAwPPlkOjSQclYC/zggYHny7dAFyWgExgCZlMaYAb4EhgG+oBrgAuBs+S5Ffn5UolQNgMviS/+J2Vbc6KjemYhWQlMpOjwYeAtmf3KzSwU9bfdwDbgtxTtfw2soGBcVxfzRjEyBtyZU0Sg4ulbgL0pBruXgqC+6v8m6NR+4AaLein380lCt3UHnnNvAn9ck8Foc6TjBuCXBLH3FjzlblHQ1IHdwHJPYvl3Ehjbu5ndG+MuTgBPO5zFOh4UV2FyI974bBVi/WlQdhq4EX/pkdyI6QXpPBpRkcI3BiX/ko74zqqYUHBfkyFn0wwZlDsKXEVxWBUzs193pViXIcJQn6+nePQYfPashIhWUcmYA4bRf4Hi8pChXxO2NxW2GpR538PoIi2m0E9tJlhhkWwr6d7Q51B8lhgWNSqPfqYNJTYaRvsRysNGQz+fsqHAZov+6wxgh6Q+VbL+NcvbUZ9p+nrQhh7LG2yg5vVG3qFZxlctRla6Wb3JVhr0J2lwUjY+s6bNsCNu09hjBh2soAyxDGjPsY1jhhlly9i3ato/CZxHSRg2GNqWsdWa4XdN+49SEqpiTNfGHjKsGUpD1QNj92jancrZdbacsSuG3fUrKRlVx8bW7Td6u+XV7Mz6MMbYe6SeJGsGNe2pz0tJxZGxt7TCC9EHN9JlKCvLDJWtelN2TaICye4MZ/ZKTRtqhZwZ2z0wWrRAUfmSLDhb83yV7MoEFSce98Bg0QJlOqNYt6p5viqzyIRgaEuGLrrr2F4U13EqAT8Ssx3vo4wW7WVYxPBuNONY+lob4Z1PVBwtWO7TtPUeJaTicAn+iqa9l2nR1WBnTu1/2gpJpapjI1ckHm/U7hWUhKpjIyM10qVO/Fc9MLJp77I0L8IRD4zcIeduGrWvahALX27QbvCLtoyMlB/ryg1yP49zPfBzXdHfPTkZesaDAppxjQ4fl6kk7G3HRu42fKPUEb7SFDkuFmPPyOAOWy5yHHNZ5GgqZ82rcqcN+/QZ+qmuoLBSiF4zFKKfS/FZKpeoNOpjzVYhumLAMNo7S3C04l0H31ptbPm9QZkXKS4DMRcFWL+BbI3h7LeKQm6jeKyLOf52tSvFthlG/6gMRlG4LKacQh3rcEZFbm7RKXdMZkkRjKyrgVbyhesjyqf20g4ZlJwGbsZf1sXMZHWhwCV4wtoE10g862E0MhBzjcRx6ZtX3JXgYpQ9nlyMsjQmhIukL7fjKf0JjF2To2OuZnefYTFSn5lTqQav2RDzdYzqciM3WdSr25C7mO8uvJ3JjbZ+TLfSRHUyLm6nM6eF1XpDqrPRi887nxzHipjbaaJ5ckQqP3ubvFWxIs8YNuRkdCGcN9FFWjplUTObosORRDBfAW+I31dVQhfLNZntYsxlcp9TlxS3DEpJgGlXppHMymLEeZyclX88kNIANmS/y2V1XnQAj8UsbmzJpGThSn1F/WLguZT+Mys5KEl7a/lkH6hITDu+AB+eRk7KRmpfq10934jzxa3sirnRIKlMSXHLVk9Wot768tXAAxJ1fCQ1yDXZKpuT3MmU/HuQCTHqoBQcXl6WMq1AIBAIBAKBQCAQwAb/A2oFBSWHMrmlAAAAAElFTkSuQmCC",l=n.p+"img/gemini.c576e400.png",u=n.p+"img/gpt.b924327a.png";n(4114),n(8111),n(2489),n(116),n(531),n(1701);const h="https://nexra.aryahcr.cc/api/chat/gptweb",g="https://nexra.aryahcr.cc/api/chat/task",p="https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=GEMINI_API_KEY";async function d(t){for(let n=0;n<30;n++){await new Promise((t=>setTimeout(t,500)));try{const e=await fetch(`${g}/${encodeURIComponent(t)}`);if(!e.ok){console.error(`Ошибка проверки задачи GPT: Статус ${e.status}`);continue}const n=await e.json();if("completed"===n.status)return n;if("error"===n.status)throw new Error(n.error||"Ошибка обработки задачи GPT на сервере")}catch(e){if(console.error("Критическая ошибка при проверке задачи GPT:",e),29===n)throw e}}throw new Error("Превышено время ожидания ответа от GPT API")}async function m(t){const e=await fetch(h,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:t,markdown:!1})});if(!e.ok)throw new Error(`Ошибка при создании задачи GPT: статус ${e.status}`);const n=await e.json();if(!n.id)throw new Error("API GPT не вернуло ID задачи");const a=await d(n.id);if(a?.gpt)return a.gpt;throw new Error("API GPT вернуло пустой ответ")}async function f(t,e){if(!e)throw new Error("Отсутствует токен для Gemini API. Добавьте его в хранилище.");const n=t.map((t=>({role:"user"===t.sender?"user":"model",parts:[{text:t.text}]}))),a=await fetch(`${p}${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:n})});if(!a.ok){const t=await a.json();throw new Error(`Ошибка Gemini API: ${t.error?.message||a.statusText}`)}const s=await a.json(),r=s?.candidates?.[0]?.content?.parts?.[0]?.text;if(!r)throw new Error("Gemini API вернуло пустой или некорректный ответ.");return r}const v=(0,s.nY)("store",{state:()=>({chats:[],tokenGemini:"AIzaSyBCOo8nssaAiEw1DRg5gkP7PksazQoyDcE",tokenGpt:"","currentСhatId":null,activePage:"main"}),persist:!0,getters:{currentChat:t=>t.chats.find((e=>e.chatId===t.currentСhatId))||null,"currentСhatMessages"(){return this.currentChat?this.currentChat.messages:[]}},actions:{_getNextChatId(){if(0===this.chats.length)return 1;const t=Math.max(...this.chats.map((t=>t.chatId)));return t+1},_getNextMessageId(){const t=this.chats.flatMap((t=>t.messages));if(0===t.length)return 1;const e=Math.max(...t.map((t=>t.msgId)));return e+1},changeChat(t){this.currentСhatId=t},async newMessage(t){if(!t||!this.currentChat)return;const e=this.currentChat.model;if(this.currentСhatMessages.push({msgId:this._getNextMessageId(),text:t,sender:"user"}),"gpt"===e||"gemini"===e){const t=this._getNextMessageId();this.currentСhatMessages.push({msgId:t,text:"печатает...",sender:e,loading:!0});try{let n="";const a=this.currentСhatMessages.filter((t=>!t.loading));if("gpt"===e){let t=a.map((t=>`${t.sender}: ${t.text}`)).join("\n");t+=`\n${e}:`,n=await m(t)}else"gemini"===e&&(n=await f(a,this.tokenGemini));const s=this.currentСhatMessages.find((e=>e.msgId===t));s&&(s.text=n.trim(),delete s.loading)}catch(n){console.error(`Ошибка при получении ответа от ${e}:`,n);const a=this.currentСhatMessages.find((e=>e.msgId===t));a&&(a.text=`Произошла ошибка: ${n.message}`,a.error=!0,delete a.loading)}}},newChat(t){const e=this._getNextChatId();this.chats.push({chatId:e,messages:[{msgId:this._getNextMessageId(),text:"Проси, что хочешь!",sender:t}],model:t,date:k()}),this.currentСhatId=e},deleteChat(t){this.chats=this.chats.filter((e=>e.chatId!==t)),this.currentСhatId===t&&(this.currentСhatId=this.chats.length>0?this.chats[0].chatId:null)},changePage(){this.activePage="main"===this.activePage?"login":"main"},saveTokens(t,e){this.tokenGemini=t,this.tokenGpt=e}}});function k(){const t=new Date,e=String(t.getDate()).padStart(2,"0"),n=String(t.getMonth()+1).padStart(2,"0");return`${e}.${n}`}const A={class:"login"};var _={__name:"appHeader",setup(t){const e=v(),{activePage:n}=(0,s.bP)(e),{changePage:a}=e;return(t,e)=>((0,r.uX)(),(0,r.CE)("nav",null,[e[5]||(e[5]=(0,r.Lk)("h1",null,"Multy Message",-1)),e[6]||(e[6]=(0,r.Lk)("a",{target:"_blank",href:"https://docs.google.com/forms/d/e/1FAIpQLSc5Hgu1mmSEZyBxy1se6L3bdigLnaKNsV5ktR0QstKNtmAj7g/viewform?usp=header"},"обратная связь",-1)),(0,r.Lk)("div",A,["main"===(0,i.R1)(n)?((0,r.uX)(),(0,r.CE)("p",{key:0,onClick:e[0]||(e[0]=(...t)=>(0,i.R1)(a)&&(0,i.R1)(a)(...t))},"Вход")):(0,r.Q3)("",!0),"login"===(0,i.R1)(n)?((0,r.uX)(),(0,r.CE)("p",{key:1,onClick:e[1]||(e[1]=(...t)=>(0,i.R1)(a)&&(0,i.R1)(a)(...t))},"Назад")):(0,r.Q3)("",!0),(0,r.Lk)("img",{onClick:e[2]||(e[2]=(...t)=>(0,i.R1)(a)&&(0,i.R1)(a)(...t)),src:c,alt:"log",id:"log"}),e[3]||(e[3]=(0,r.Lk)("img",{src:l,alt:"gpt"},null,-1)),e[4]||(e[4]=(0,r.Lk)("img",{src:u,alt:"gemeni"},null,-1))])]))}},b=n(1241);const C=(0,b.A)(_,[["__scopeId","data-v-61c162f6"]]);var y=C,I=n(4232);const w={class:"chatlist"},E={key:0},L=["onClick"],R={class:"chatlist__chat__meta"},P={class:"chatlist__chat__meta__top"},x={class:"chatlist__chat__meta__bottom"},M=["onClick"],G={class:"chatlist__add"};var X={__name:"ChatsList",setup(t){const e=v(),{chats:n}=(0,s.bP)(e),{changeChat:a,newChat:o,deleteChat:c}=e;return(t,e)=>((0,r.uX)(),(0,r.CE)("div",w,[(0,i.R1)(n)?((0,r.uX)(),(0,r.CE)("div",E,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)((0,i.R1)(n),(t=>((0,r.uX)(),(0,r.CE)("div",{class:(0,I.C4)(["chatlist__chat",t.model]),onClick:e=>(0,i.R1)(a)(t.chatId),key:t.id},[e[2]||(e[2]=(0,r.Lk)("div",{class:"chatlist__chat__left"},[(0,r.Lk)("div",{class:"chatlist__chat__img"})],-1)),(0,r.Lk)("div",R,[(0,r.Lk)("div",P,[(0,r.Lk)("h1",null,"Чат #"+(0,I.v_)(t.chatId),1),(0,r.Lk)("p",null,(0,I.v_)(t.date),1)]),(0,r.Lk)("div",x,[(0,r.Lk)("span",null,(0,I.v_)(t.messages.at(-1).text),1),(0,r.Lk)("button",{onClick:e=>(0,i.R1)(c)(t.chatId)},"✕",8,M)])])],10,L)))),128))])):(0,r.Q3)("",!0),(0,r.Lk)("div",G,[(0,r.Lk)("button",{onClick:e[0]||(e[0]=t=>(0,i.R1)(o)("gpt"))},"Gpt"),(0,r.Lk)("button",{onClick:e[1]||(e[1]=t=>(0,i.R1)(o)("gemini"))},"Gemini")])]))}};const T=(0,b.A)(X,[["__scopeId","data-v-7b47a885"]]);var j=T;const F={class:"chat__messages"};var N={__name:"MessagesList",setup(t){const e=v(),{"currentСhatMessages":n}=(0,s.bP)(e);return(t,e)=>((0,r.uX)(),(0,r.CE)("div",F,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)((0,i.R1)(n),(t=>((0,r.uX)(),(0,r.CE)("div",{class:(0,I.C4)(["chat__message",t.sender]),key:t.msgId},[(0,r.Lk)("p",null,(0,I.v_)(t.text),1)],2)))),128))]))}};const S=(0,b.A)(N,[["__scopeId","data-v-00a1ab5e"]]);var Q=S,B={__name:"MessageForm",props:{modelValue:{type:String},modelModifiers:{}},emits:["update:modelValue"],setup(t){const e=(0,r.fn)(t,"modelValue"),n=v(),{chats:o}=(0,s.bP)(n),{newMessage:c}=n;function l(){c(e.value.trim()),e.value=""}return(t,n)=>(0,i.R1)(o)[0]?((0,r.uX)(),(0,r.CE)("form",{key:0,onSubmit:(0,a.D$)(l,["prevent"])},[(0,r.bo)((0,r.Lk)("input",{type:"text","onUpdate:modelValue":n[0]||(n[0]=t=>e.value=t),placeholder:"Введите сообщение..."},null,512),[[a.Jo,e.value]]),n[1]||(n[1]=(0,r.Lk)("button",{type:"submit"},null,-1))],32)):(0,r.Q3)("",!0)}};const O=(0,b.A)(B,[["__scopeId","data-v-3a788bf7"]]);var K=O;const Z={class:"chat"};var W={__name:"ChatBlock",setup(t){return(t,e)=>((0,r.uX)(),(0,r.CE)("div",Z,[(0,r.bF)(Q),(0,r.bF)(K)]))}};const J=(0,b.A)(W,[["__scopeId","data-v-5cff7ddb"]]);var Y=J,H=n.p+"img/gpt_active.3d93388b.png",V=n.p+"img/gemini_active.8ab3d4cc.png";const q={class:"login-container"},U={class:"input-group"},z={class:"input-group__icon"},D={key:0,src:u},$={key:1,src:H},tt={class:"input-group"},et={class:"input-group__icon"},nt={key:0,src:l},at={key:1,src:V};var st={__name:"appLogin",setup(t){const e=v(),{tokenGemini:n,tokenGpt:o}=(0,s.bP)(e),c=(0,i.KR)(""),l=(0,i.KR)(""),u=(t,n)=>{e.saveTokens(t,n),c.value="",l.value=""};return(t,e)=>((0,r.uX)(),(0,r.CE)("div",q,[(0,r.Lk)("form",{class:"login-form",onSubmit:e[2]||(e[2]=(0,a.D$)((t=>u(l.value,c.value)),["prevent"]))},[e[3]||(e[3]=(0,r.Lk)("h2",{class:"login-form__title"},"ВХОД",-1)),(0,r.Lk)("div",U,[(0,r.Lk)("div",z,[""==(0,i.R1)(o)?((0,r.uX)(),(0,r.CE)("img",D)):((0,r.uX)(),(0,r.CE)("img",$))]),(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>c.value=t),type:"text",class:"input-group__input",placeholder:"Токен ChatGPT","aria-label":"Токен ChatGPT"},null,512),[[a.Jo,c.value]])]),(0,r.Lk)("div",tt,[(0,r.Lk)("div",et,[""==(0,i.R1)(n)?((0,r.uX)(),(0,r.CE)("img",nt)):((0,r.uX)(),(0,r.CE)("img",at))]),(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>l.value=t),type:"text",class:"input-group__input",placeholder:"Токен Gemini","aria-label":"Токен Gemini"},null,512),[[a.Jo,l.value]])]),e[4]||(e[4]=(0,r.Lk)("button",{type:"submit",class:"login-form__button"},"Сохранить токен",-1)),e[5]||(e[5]=(0,r.Lk)("a",{target:"_blank",href:"https://docs.google.com/document/d/15y8hTKGTWBbTZITkLnNtly_z5lwKGQwRVJ27GcYt3KI/edit?usp=sharing",class:"login-form__link"},"как получить токен?",-1))],32)]))}};const rt=(0,b.A)(st,[["__scopeId","data-v-1636814c"]]);var ot=rt,it={__name:"appMain",setup(t){const e=v(),{activePage:n}=(0,s.bP)(e);return(t,e)=>((0,r.uX)(),(0,r.CE)("main",null,["main"===(0,i.R1)(n)?((0,r.uX)(),(0,r.Wv)(j,{key:0})):(0,r.Q3)("",!0),"main"===(0,i.R1)(n)?((0,r.uX)(),(0,r.Wv)(Y,{key:1})):(0,r.Q3)("",!0),"login"===(0,i.R1)(n)?((0,r.uX)(),(0,r.Wv)(ot,{key:2})):(0,r.Q3)("",!0)]))}};const ct=(0,b.A)(it,[["__scopeId","data-v-bf28a530"]]);var lt=ct,ut={name:"App",components:{Header:y,Main:lt}};const ht=(0,b.A)(ut,[["render",o]]);var gt=ht,pt=n(5827);const dt=(0,a.Ef)(gt),mt=(0,s.Ey)();mt.use(pt.A),dt.use(mt),dt.mount("#app")}},e={};function n(a){var s=e[a];if(void 0!==s)return s.exports;var r=e[a]={exports:{}};return t[a].call(r.exports,r,r.exports,n),r.exports}n.m=t,function(){var t=[];n.O=function(e,a,s,r){if(!a){var o=1/0;for(u=0;u<t.length;u++){a=t[u][0],s=t[u][1],r=t[u][2];for(var i=!0,c=0;c<a.length;c++)(!1&r||o>=r)&&Object.keys(n.O).every((function(t){return n.O[t](a[c])}))?a.splice(c--,1):(i=!1,r<o&&(o=r));if(i){t.splice(u--,1);var l=s();void 0!==l&&(e=l)}}return e}r=r||0;for(var u=t.length;u>0&&t[u-1][2]>r;u--)t[u]=t[u-1];t[u]=[a,s,r]}}(),function(){n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,{a:e}),e}}(),function(){n.d=function(t,e){for(var a in e)n.o(e,a)&&!n.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){n.p="/"}(),function(){var t={524:0};n.O.j=function(e){return 0===t[e]};var e=function(e,a){var s,r,o=a[0],i=a[1],c=a[2],l=0;if(o.some((function(e){return 0!==t[e]}))){for(s in i)n.o(i,s)&&(n.m[s]=i[s]);if(c)var u=c(n)}for(e&&e(a);l<o.length;l++)r=o[l],n.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return n.O(u)},a=self["webpackChunkmultymessage"]=self["webpackChunkmultymessage"]||[];a.forEach(e.bind(null,0)),a.push=e.bind(null,a.push.bind(a))}();var a=n.O(void 0,[504],(function(){return n(9313)}));a=n.O(a)})();
//# sourceMappingURL=app.8ec0ef6d.js.map