(function(){"use strict";var t={8046:function(t,e,n){var a=n(5130),s=n(2261),r=n(6768);function i(t,e,n,a,s,i){const o=(0,r.g2)("Header"),c=(0,r.g2)("Main");return(0,r.uX)(),(0,r.CE)(r.FK,null,[(0,r.bF)(o),(0,r.bF)(c)],64)}var o=n(144),c="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFoAAABaCAYAAAA4qEECAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFgklEQVR4nO2dXWgdRRSAv8R4b7Q/YFHrP63vxZ+iNaZJEfG3KIKtpkRs/SX1/wcfBPFNo1ITJCjtk0+CL2rR2lRtyIOoFUsErY/qg1VvrGlrNY2lJisDp3AJd2Z3c3dnZvfOBwfCDdk5c2bu2TNnzkwgEAgEAoFAIBAIBAKJOR1YAzwMjAC7gO+ASeAwEAEn5Ocf5XcfAK8C9wOrgdOSN9daXAQ8AYwCf4sxm5EjwE7gceACWpwq0A98DsxlYFyd/CcD2C9ttgxLgOeBP3I0rk5+BZ4BFlFy3/skMOXAwPPlkOjSQclYC/zggYHny7dAFyWgExgCZlMaYAb4EhgG+oBrgAuBs+S5Ffn5UolQNgMviS/+J2Vbc6KjemYhWQlMpOjwYeAtmf3KzSwU9bfdwDbgtxTtfw2soGBcVxfzRjEyBtyZU0Sg4ulbgL0pBruXgqC+6v8m6NR+4AaLein380lCt3UHnnNvAn9ck8Foc6TjBuCXBLH3FjzlblHQ1IHdwHJPYvl3Ehjbu5ndG+MuTgBPO5zFOh4UV2FyI974bBVi/WlQdhq4EX/pkdyI6QXpPBpRkcI3BiX/ko74zqqYUHBfkyFn0wwZlDsKXEVxWBUzs193pViXIcJQn6+nePQYfPashIhWUcmYA4bRf4Hi8pChXxO2NxW2GpR538PoIi2m0E9tJlhhkWwr6d7Q51B8lhgWNSqPfqYNJTYaRvsRysNGQz+fsqHAZov+6wxgh6Q+VbL+NcvbUZ9p+nrQhh7LG2yg5vVG3qFZxlctRla6Wb3JVhr0J2lwUjY+s6bNsCNu09hjBh2soAyxDGjPsY1jhhlly9i3ato/CZxHSRg2GNqWsdWa4XdN+49SEqpiTNfGHjKsGUpD1QNj92jancrZdbacsSuG3fUrKRlVx8bW7Td6u+XV7Mz6MMbYe6SeJGsGNe2pz0tJxZGxt7TCC9EHN9JlKCvLDJWtelN2TaICye4MZ/ZKTRtqhZwZ2z0wWrRAUfmSLDhb83yV7MoEFSce98Bg0QJlOqNYt6p5viqzyIRgaEuGLrrr2F4U13EqAT8Ssx3vo4wW7WVYxPBuNONY+lob4Z1PVBwtWO7TtPUeJaTicAn+iqa9l2nR1WBnTu1/2gpJpapjI1ckHm/U7hWUhKpjIyM10qVO/Fc9MLJp77I0L8IRD4zcIeduGrWvahALX27QbvCLtoyMlB/ryg1yP49zPfBzXdHfPTkZesaDAppxjQ4fl6kk7G3HRu42fKPUEb7SFDkuFmPPyOAOWy5yHHNZ5GgqZ82rcqcN+/QZ+qmuoLBSiF4zFKKfS/FZKpeoNOpjzVYhumLAMNo7S3C04l0H31ptbPm9QZkXKS4DMRcFWL+BbI3h7LeKQm6jeKyLOf52tSvFthlG/6gMRlG4LKacQh3rcEZFbm7RKXdMZkkRjKyrgVbyhesjyqf20g4ZlJwGbsZf1sXMZHWhwCV4wtoE10g862E0MhBzjcRx6ZtX3JXgYpQ9nlyMsjQmhIukL7fjKf0JjF2To2OuZnefYTFSn5lTqQav2RDzdYzqciM3WdSr25C7mO8uvJ3JjbZ+TLfSRHUyLm6nM6eF1XpDqrPRi887nxzHipjbaaJ5ckQqP3ubvFWxIs8YNuRkdCGcN9FFWjplUTObosORRDBfAW+I31dVQhfLNZntYsxlcp9TlxS3DEpJgGlXppHMymLEeZyclX88kNIANmS/y2V1XnQAj8UsbmzJpGThSn1F/WLguZT+Mys5KEl7a/lkH6hITDu+AB+eRk7KRmpfq10934jzxa3sirnRIKlMSXHLVk9Wot768tXAAxJ1fCQ1yDXZKpuT3MmU/HuQCTHqoBQcXl6WMq1AIBAIBAKBQCAQwAb/A2oFBSWHMrmlAAAAAElFTkSuQmCC",l=n.p+"img/gemini.c576e400.png",u=n.p+"img/gemini_active.8ab3d4cc.png",h=n.p+"img/gpt.b924327a.png",g=n.p+"img/gpt_active.3d93388b.png";n(4114),n(8111),n(2489),n(116),n(531),n(1701);const p="https://nexra.aryahcr.cc/api/chat/gptweb",d="https://nexra.aryahcr.cc/api/chat/task",m="https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=GEMINI_API_KEY";async function f(t){for(let n=0;n<30;n++){await new Promise((t=>setTimeout(t,500)));try{const e=await fetch(`${d}/${encodeURIComponent(t)}`);if(!e.ok){console.error(`Ошибка проверки задачи GPT: Статус ${e.status}`);continue}const n=await e.json();if("completed"===n.status)return n;if("error"===n.status)throw new Error(n.error||"Ошибка обработки задачи GPT на сервере")}catch(e){if(console.error("Критическая ошибка при проверке задачи GPT:",e),29===n)throw e}}throw new Error("Превышено время ожидания ответа от GPT API")}async function k(t){const e=await fetch(p,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:t,markdown:!1})});if(!e.ok)throw new Error(`Ошибка при создании задачи GPT: статус ${e.status}`);const n=await e.json();if(!n.id)throw new Error("API GPT не вернуло ID задачи");const a=await f(n.id);if(a?.gpt)return a.gpt;throw new Error("API GPT вернуло пустой ответ")}async function v(t,e){if(!e)throw new Error("Отсутствует токен для Gemini API. Добавьте его в хранилище.");const n=t.map((t=>({role:"user"===t.sender?"user":"model",parts:[{text:t.text}]}))),a=await fetch(`${m}${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:n})});if(!a.ok){const t=await a.json();throw new Error(`Ошибка Gemini API: ${t.error?.message||a.statusText}`)}const s=await a.json(),r=s?.candidates?.[0]?.content?.parts?.[0]?.text;if(!r)throw new Error("Gemini API вернуло пустой или некорректный ответ.");return r}const A=(0,s.nY)("store",{state:()=>({chats:[],tokenGemini:"AIzaSyBCOo8nssaAiEw1DRg5gkP7PksazQoyDcE",tokenGpt:"","currentСhatId":null,activePage:"main"}),persist:!0,getters:{currentChat:t=>t.chats.find((e=>e.chatId===t.currentСhatId))||null,"currentСhatMessages"(){return this.currentChat?this.currentChat.messages:[]}},actions:{_getNextChatId(){if(0===this.chats.length)return 1;const t=Math.max(...this.chats.map((t=>t.chatId)));return t+1},_getNextMessageId(){const t=this.chats.flatMap((t=>t.messages));if(0===t.length)return 1;const e=Math.max(...t.map((t=>t.msgId)));return e+1},changeChat(t){this.currentСhatId=t},async newMessage(t){if(!t||!this.currentChat)return;const e=this.currentChat.model;if(this.currentСhatMessages.push({msgId:this._getNextMessageId(),text:t,sender:"user"}),"gpt"===e||"gemini"===e){const t=this._getNextMessageId();this.currentСhatMessages.push({msgId:t,text:"печатает...",sender:e,loading:!0});try{let n="";const a=this.currentСhatMessages.filter((t=>!t.loading));if("gpt"===e){let t=a.map((t=>`${t.sender}: ${t.text}`)).join("\n");t+=`\n${e}:`,n=await k(t)}else"gemini"===e&&(n=await v(a,this.tokenGemini));const s=this.currentСhatMessages.find((e=>e.msgId===t));s&&(s.text=n.trim(),delete s.loading)}catch(n){console.error(`Ошибка при получении ответа от ${e}:`,n);const a=this.currentСhatMessages.find((e=>e.msgId===t));a&&(a.text=`Произошла ошибка: ${n.message}`,a.error=!0,delete a.loading)}}},newChat(t){const e=this._getNextChatId();this.chats.push({chatId:e,messages:[{msgId:this._getNextMessageId(),text:"Проси, что хочешь!",sender:t}],model:t,date:_()}),this.currentСhatId=e},deleteChat(t){this.chats=this.chats.filter((e=>e.chatId!==t)),this.currentСhatId===t&&(this.currentСhatId=this.chats.length>0?this.chats[0].chatId:null)},changePage(){this.activePage="main"===this.activePage?"login":"main"},saveTokens(t,e){this.tokenGemini=t,this.tokenGpt=e}}});function _(){const t=new Date,e=String(t.getDate()).padStart(2,"0"),n=String(t.getMonth()+1).padStart(2,"0");return`${e}.${n}`}const C={class:"login"},y={key:2,src:l,alt:"gemini"},b={key:3,src:u,alt:"gemini"},I={key:4,src:h,alt:"gpt"},w={key:5,src:g,alt:"gpt"};var E={__name:"appHeader",setup(t){const e=A(),{activePage:n,tokenGemini:a,tokenGpt:i}=(0,s.bP)(e),{changePage:l}=e;return(t,e)=>((0,r.uX)(),(0,r.CE)("nav",null,[e[3]||(e[3]=(0,r.Lk)("h1",null,"Multy Message",-1)),e[4]||(e[4]=(0,r.Lk)("a",{target:"_blank",href:"https://docs.google.com/forms/d/e/1FAIpQLSc5Hgu1mmSEZyBxy1se6L3bdigLnaKNsV5ktR0QstKNtmAj7g/viewform?usp=header"},"обратная связь",-1)),(0,r.Lk)("div",C,["main"===(0,o.R1)(n)?((0,r.uX)(),(0,r.CE)("p",{key:0,onClick:e[0]||(e[0]=(...t)=>(0,o.R1)(l)&&(0,o.R1)(l)(...t))},"Вход")):(0,r.Q3)("",!0),"login"===(0,o.R1)(n)?((0,r.uX)(),(0,r.CE)("p",{key:1,onClick:e[1]||(e[1]=(...t)=>(0,o.R1)(l)&&(0,o.R1)(l)(...t))},"Назад")):(0,r.Q3)("",!0),(0,r.Lk)("img",{onClick:e[2]||(e[2]=(...t)=>(0,o.R1)(l)&&(0,o.R1)(l)(...t)),src:c,alt:"log",id:"log"}),""==(0,o.R1)(a)?((0,r.uX)(),(0,r.CE)("img",y)):((0,r.uX)(),(0,r.CE)("img",b)),""==(0,o.R1)(i)?((0,r.uX)(),(0,r.CE)("img",I)):((0,r.uX)(),(0,r.CE)("img",w))])]))}},R=n(1241);const L=(0,R.A)(E,[["__scopeId","data-v-762f2ea0"]]);var P=L,x=n(4232);const X={class:"chatlist"},G={key:0},M=["onClick"],T={class:"chatlist__chat__meta"},j={class:"chatlist__chat__meta__top"},F={class:"chatlist__chat__meta__bottom"},N=["onClick"],S={class:"chatlist__add"};var Q={__name:"ChatsList",setup(t){const e=A(),{chats:n}=(0,s.bP)(e),{changeChat:a,newChat:i,deleteChat:c}=e;return(t,e)=>((0,r.uX)(),(0,r.CE)("div",X,[(0,o.R1)(n)?((0,r.uX)(),(0,r.CE)("div",G,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)((0,o.R1)(n),(t=>((0,r.uX)(),(0,r.CE)("div",{class:(0,x.C4)(["chatlist__chat",t.model]),onClick:e=>(0,o.R1)(a)(t.chatId),key:t.id},[e[2]||(e[2]=(0,r.Lk)("div",{class:"chatlist__chat__left"},[(0,r.Lk)("div",{class:"chatlist__chat__img"})],-1)),(0,r.Lk)("div",T,[(0,r.Lk)("div",j,[(0,r.Lk)("h1",null,"Чат #"+(0,x.v_)(t.chatId),1),(0,r.Lk)("p",null,(0,x.v_)(t.date),1)]),(0,r.Lk)("div",F,[(0,r.Lk)("span",null,(0,x.v_)(t.messages.at(-1).text),1),(0,r.Lk)("button",{onClick:e=>(0,o.R1)(c)(t.chatId)},"✕",8,N)])])],10,M)))),128))])):(0,r.Q3)("",!0),(0,r.Lk)("div",S,[(0,r.Lk)("button",{onClick:e[0]||(e[0]=t=>(0,o.R1)(i)("gpt"))},"Gpt"),(0,r.Lk)("button",{onClick:e[1]||(e[1]=t=>(0,o.R1)(i)("gemini"))},"Gemini")])]))}};const B=(0,R.A)(Q,[["__scopeId","data-v-7b47a885"]]);var O=B;const K={class:"chat__messages"};var Z={__name:"MessagesList",setup(t){const e=A(),{"currentСhatMessages":n}=(0,s.bP)(e);return(t,e)=>((0,r.uX)(),(0,r.CE)("div",K,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)((0,o.R1)(n),(t=>((0,r.uX)(),(0,r.CE)("div",{class:(0,x.C4)(["chat__message",t.sender]),key:t.msgId},[(0,r.Lk)("p",null,(0,x.v_)(t.text),1)],2)))),128))]))}};const W=(0,R.A)(Z,[["__scopeId","data-v-00a1ab5e"]]);var J=W,Y={__name:"MessageForm",props:{modelValue:{type:String},modelModifiers:{}},emits:["update:modelValue"],setup(t){const e=(0,r.fn)(t,"modelValue"),n=A(),{chats:i}=(0,s.bP)(n),{newMessage:c}=n;function l(){c(e.value.trim()),e.value=""}return(t,n)=>(0,o.R1)(i)[0]?((0,r.uX)(),(0,r.CE)("form",{key:0,onSubmit:(0,a.D$)(l,["prevent"])},[(0,r.bo)((0,r.Lk)("input",{type:"text","onUpdate:modelValue":n[0]||(n[0]=t=>e.value=t),placeholder:"Введите сообщение..."},null,512),[[a.Jo,e.value]]),n[1]||(n[1]=(0,r.Lk)("button",{type:"submit"},null,-1))],32)):(0,r.Q3)("",!0)}};const H=(0,R.A)(Y,[["__scopeId","data-v-3a788bf7"]]);var V=H;const q={class:"chat"};var U={__name:"ChatBlock",setup(t){return(t,e)=>((0,r.uX)(),(0,r.CE)("div",q,[(0,r.bF)(J),(0,r.bF)(V)]))}};const z=(0,R.A)(U,[["__scopeId","data-v-5cff7ddb"]]);var D=z;const $={class:"login-container"},tt={class:"input-group"},et={class:"input-group__icon"},nt={key:0,src:h},at={key:1,src:g},st={class:"input-group"},rt={class:"input-group__icon"},it={key:0,src:l},ot={key:1,src:u};var ct={__name:"appLogin",setup(t){const e=A(),{tokenGemini:n,tokenGpt:i}=(0,s.bP)(e),c=(0,o.KR)(""),l=(0,o.KR)(""),u=(t,n)=>{e.saveTokens(t,n),c.value="",l.value=""};return(t,e)=>((0,r.uX)(),(0,r.CE)("div",$,[(0,r.Lk)("form",{class:"login-form",onSubmit:e[2]||(e[2]=(0,a.D$)((t=>u(l.value,c.value)),["prevent"]))},[e[3]||(e[3]=(0,r.Lk)("h2",{class:"login-form__title"},"ВХОД",-1)),(0,r.Lk)("div",tt,[(0,r.Lk)("div",et,[""==(0,o.R1)(i)?((0,r.uX)(),(0,r.CE)("img",nt)):((0,r.uX)(),(0,r.CE)("img",at))]),(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>c.value=t),type:"text",class:"input-group__input",placeholder:"Токен ChatGPT","aria-label":"Токен ChatGPT"},null,512),[[a.Jo,c.value]])]),(0,r.Lk)("div",st,[(0,r.Lk)("div",rt,[""==(0,o.R1)(n)?((0,r.uX)(),(0,r.CE)("img",it)):((0,r.uX)(),(0,r.CE)("img",ot))]),(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>l.value=t),type:"text",class:"input-group__input",placeholder:"Токен Gemini","aria-label":"Токен Gemini"},null,512),[[a.Jo,l.value]])]),e[4]||(e[4]=(0,r.Lk)("button",{type:"submit",class:"login-form__button"},"Сохранить токен",-1)),e[5]||(e[5]=(0,r.Lk)("a",{target:"_blank",href:"https://docs.google.com/document/d/15y8hTKGTWBbTZITkLnNtly_z5lwKGQwRVJ27GcYt3KI/edit?usp=sharing",class:"login-form__link"},"как получить токен?",-1))],32)]))}};const lt=(0,R.A)(ct,[["__scopeId","data-v-1636814c"]]);var ut=lt,ht={__name:"appMain",setup(t){const e=A(),{activePage:n}=(0,s.bP)(e);return(t,e)=>((0,r.uX)(),(0,r.CE)("main",null,["main"===(0,o.R1)(n)?((0,r.uX)(),(0,r.Wv)(O,{key:0})):(0,r.Q3)("",!0),"main"===(0,o.R1)(n)?((0,r.uX)(),(0,r.Wv)(D,{key:1})):(0,r.Q3)("",!0),"login"===(0,o.R1)(n)?((0,r.uX)(),(0,r.Wv)(ut,{key:2})):(0,r.Q3)("",!0)]))}};const gt=(0,R.A)(ht,[["__scopeId","data-v-bf28a530"]]);var pt=gt,dt={name:"App",components:{Header:P,Main:pt}};const mt=(0,R.A)(dt,[["render",i]]);var ft=mt,kt=n(5827);const vt=(0,a.Ef)(ft),At=(0,s.Ey)();At.use(kt.A),vt.use(At),vt.mount("#app")}},e={};function n(a){var s=e[a];if(void 0!==s)return s.exports;var r=e[a]={exports:{}};return t[a].call(r.exports,r,r.exports,n),r.exports}n.m=t,function(){var t=[];n.O=function(e,a,s,r){if(!a){var i=1/0;for(u=0;u<t.length;u++){a=t[u][0],s=t[u][1],r=t[u][2];for(var o=!0,c=0;c<a.length;c++)(!1&r||i>=r)&&Object.keys(n.O).every((function(t){return n.O[t](a[c])}))?a.splice(c--,1):(o=!1,r<i&&(i=r));if(o){t.splice(u--,1);var l=s();void 0!==l&&(e=l)}}return e}r=r||0;for(var u=t.length;u>0&&t[u-1][2]>r;u--)t[u]=t[u-1];t[u]=[a,s,r]}}(),function(){n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,{a:e}),e}}(),function(){n.d=function(t,e){for(var a in e)n.o(e,a)&&!n.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){n.p="/"}(),function(){var t={524:0};n.O.j=function(e){return 0===t[e]};var e=function(e,a){var s,r,i=a[0],o=a[1],c=a[2],l=0;if(i.some((function(e){return 0!==t[e]}))){for(s in o)n.o(o,s)&&(n.m[s]=o[s]);if(c)var u=c(n)}for(e&&e(a);l<i.length;l++)r=i[l],n.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return n.O(u)},a=self["webpackChunkmultymessage"]=self["webpackChunkmultymessage"]||[];a.forEach(e.bind(null,0)),a.push=e.bind(null,a.push.bind(a))}();var a=n.O(void 0,[504],(function(){return n(8046)}));a=n.O(a)})();
//# sourceMappingURL=app.a9f9e03e.js.map